ChiTu G-Codes (Resin) – Erweiterte Referenz
==========================================
Getestet auf Elegoo Mars Pro/Saturn (UART/Serial & "ChiTu HB" Debug-Konsole). Links zu Marlin dienen nur als Referenz – ChiTu ist **nicht** Marlin.

Inhalt
------
1. Informationsbefehle
2. Bewegungsbefehle
3. Drucksteuerung
4. Dateisystembefehle
5. Z-/Plattform-Konfiguration
6. Netzwerk/WiFi
7. Unbekannte/undokumentierte Befehle
8. Chitubox-Netzwerk-Transfer
9. Konsolen-Ausgaben
10. Konfigurations- und Diagnose-Dumps
11. Zusätzliche nicht-FDM-Befehle aus CHITU_FIRMWARE_COMMANDS_Translated_V1.4.0.txt


1. Informationsbefehle
----------------------
- **M27** – Druckfortschritt (Dateiposition relativ).  
  Antwort: `SD printing byte <pos>/<size>` bzw. `Error:It's not printing now!`

- **M110 N0** – Setzt Zeilennummer, damit der Controller keine falsche Reihenfolge meldet.  
  Antwort: `\x00`

- **M114** – Aktuelle Achsposition (mm ab Home).  
  Antwort: `ok C: X:0.000000 Y:0.000000 Z:<pos> E:0.000000`

- **M115** – Firmware-Build-Information.  
  Antwort: `ok CBD make it.Date:<date> Time:<time>`

- **M4000** – Hardwarestatus.
  Antwort: `ok B:<bed>/<bed_target> X:<x> Y:<y> Z:<z> F:<fan1>/<fan2> D:<file_pos>/<file_size>/<paused>`
  - Feldbedeutungen (aus Originalquelle): `B` = Heizbett-Ist/Soll, `E1`/`E2` = Hotend-Temperaturen,
    `X/Y/Z` = Achspositionen, `F` = Lüfter-PWM, `D` = Dateiposition/Größe/Pausenstatus.

- **M4001** – Basis-Controller-Konfiguration (Steps/mm etc.).
  - Feldaufteilung (aus Originalquelle): Steps/mm für `X/Y/Z/E`, `T` = Maschinentyp und Bauraumabmessungen
    inkl. Hotend-Anzahl, `U` = Zeichencodierung, `B` = Heizbett aktiviert.

- **M4002** – Firmware-Version (`ok V4.3.3_LCDC`).

- **M4006** – Dateiname des aktuellen Druckjobs.


2. Bewegungsbefehle
-------------------
- **G0 Z<mm> F<mm/min>** – Lineare Z-Bewegung.  
  Antwort: `ok N:<#>`

- **G28** – Homen der Bauplatte.  
  Antwort: *keine*

- **G29** – "Resin-Stirrer": fährt die Bauplatte ~50× auf/ab.  
  Antwort: `ok N:<#>`

- **G90** – Absolute Positionierung.  
  Antwort: *keine*

- **G91** – Inkrementelle Positionierung.  
  Antwort: *keine*


3. Drucksteuerung
-----------------
- **M24** – Fortsetzen eines pausierten Drucks.  
  Antwort: `ok N:<#>`

- **M25** – Pause.  
  Antwort: `ok N:<#>`

- **M33** – Druck stoppen.  
  Antwort: `ok N:<#>` bzw. `Error:It's not printing now!`

- **M106 S<0..256>** – LED-/Kühl-Lüfter-PWM setzen.  
  Antwort: `ok N:<#>`

- **M112** – Not-Aus, trennt auch die Serielle.  
  Antwort: `ok N:<#>`

- **M6030 '<datei>'** – Startet Druckjob von USB.  
  Antwort: `ok N:<#>`


4. Dateisystembefehle
---------------------
- **M20** – Dateiliste des Speichermediums ausgeben.  
  Antwort: `Begin file list ... End file list`

- **M28 <datei>** – Manueller Stream-Write auf USB starten. Alle Befehle außer M4000/M29 werden als Daten geschrieben (empfohlene Paketgröße ≤ 256*5). Fehlertests per XOR/0x83, bei Fehler `resend`-Aufforderung.  
  Abschluss mit **M29**.

- **M29** – Beendet manuellen Stream und schließt Datei.  
  Beispiel-Antworten: `Manual streaming done. Re-enabling temperature polling. ... Done saving file!`

- **M30 <datei>** – Löscht Datei vom USB.  
  Antwort: `File deleted :<NAME>`


5. Z-/Plattform-Konfiguration
-----------------------------
**Basisparameter**
- **M8004 I±1** – Z-Motorrichtung (1: reverse, -1: forward).
- **M8005 Z0/1** – Manuelle Z-Bewegungslogik (0: normal, 1: invertiert).
- **M8006 I<mm/s>** – Standard-Z-Geschwindigkeit.
- **M8007 I<mm/s>** – Jerk.
- **M8008 I<mm/s²>** – Beschleunigung.
- **M8010 S<steps/mm>** – Z-Steps/mm.
- **M8013 I<mm/s>** – Z-Max-Speed.

**Geschwindigkeiten & Dwell**
- **M8015 I<homing> T<peel/lift>** – Primäre Geschwindigkeiten.
- **M8016 I<homing2> T<lift_between_layers> D<ms_hold>** – Sekundäre Geschwindigkeiten/Dwell.

**Z-Hub & Endschalter**
- **M8026 I<mm>** – Maximale Z-Höhe.
- **M8029 I<t> T<wiring> S<pos> C<action>** – Endstop-Konfiguration (Z-/Z+, NO/NC, Rücksprung nach Homing).
- **M8030 I<LED_Fan> T<MB_Fan> S<LED> C<post-home>** – Aktionen nach Homing inkl. Lüfter/LED-Steuerung.

**USB & Beleuchtung**
- **M8034 I0/1** – USB-Geräteunterstützung aktivieren/deaktivieren.
- **M8070 Z<fast> S<slow>** – Peel-/Lift-Distanzen.
  - Parameterzuordnung (aus Originalquelle): `Z` = Fast Move (Peel & Lift Distance), `S` = Slow Move (Peel & First Move).
  - Hinweise: Weitere M8070-Parameter in Backup unten.

**Z-Nullpunkt & Offset**
- **M8083 I0/1** – Nullpunkt vs. Endstop (gleich/versetzt).
- **M8084 Z<mm>** – Z-Offset (z.B. Delta-Z-Korrektur).

**Touchscreen & Peripherie**
- **M8085 I<ms> T<sec>** – Boot-Logo-Dauer und Screensaver-Zeit.
  - Wertebereiche/Verhalten (aus Originalquelle): `I` zwischen 100–6000 ms; `T=0` deaktiviert den Screensaver.
- **M8087 I<ns> T<ns>** – Externe Treiber: Richtungs-Setup-Zeit & minimale Pulsdauer (0 bei internem Treiber).

**Debug & Abschluss**
- **M8093 I1** – Debug-Info auf USB schreiben (`Machine_Errer_Code.status`).
- **M8489 P<0..3>** – Aktion nach Druckende (0 disable motors, 1 nichts, 2 Home+Disable, 3 Z auf Max + Disable).
- **M8500** – Konfigurationsänderungen in EEPROM speichern.
- **M8512 "<datei>.gcode"** – Aktuelle Konfiguration in **absoluten** Pfad speichern.
  - Der Dateiname (inkl. `.gcode`) wird exakt übernommen, z.B. `"/config/backup.gcode"`.
  - Der Pfad muss existieren; ein nicht vorhandener absoluter Pfad führt zu einem Fehler (Datei wird nicht angelegt).
- **M8513** – Alle Konfigurationsparameter löschen (Werkseinstellungen).


6. Netzwerk/WiFi
----------------
- **M9003 '"ssid","pw"'** – WiFi-Client konfigurieren.  
  Antwort: `ok N:<#>`

- **M9005 '"ssid","pw"'** – WiFi-Hotspot konfigurieren.  
  Antwort: `ok N:<#>`

- **M99999** – LAN-Broadcast zum Auffinden des Geräts.  
  Antwort: `ok MAC:<...> IP:<...> VER:<...> ID:<...> Name:<...>`


7. Unbekannte/undokumentierte Befehle
-------------------------------------
- **M23** – Unbekannt; Antwort: `Error:no file was selected!`
- **M4004** – Unbekannt; Antwort: `ok C:0`
- **M5000** – Unbekannt; Antwort: `Error:auth length should be 16,yours:-1`
- **M5002** – Vermutlich Build-/Controller-ID; Antwort: `0x350041 0x4d485001 0x20393150`


8. Chitubox-Netzwerk-Transfer
-----------------------------
1. In `<install_path>\CHITUBOX\resource\machine\ELEGOO_MARS_Pro.cfg` `bNetSending` von 0 auf 1 setzen.
2. Chitubox sendet per UDP (Port 3000) **M99999** → Drucker antwortet mit Name/IP.
3. Danach sendet Chitubox **M4001** → Antwort `ok. X:0.0 Y:0.0 Z:0.0 U:'UTF-8'`.
4. Dateiübertragung startet mit **M28 <filename>**, Datenpakete: `|Valid kB|addr(4B)|test(1B)|0x83|` (XOR-Checks).  
   Abschluss **M29**; bei Fehler `resend <address>`.


9. Konsolen-Ausgaben
--------------------
- **Power-On**: `UART1 init OK`, `start`, `start_task`, `USB disk_OK`, `//############Error!cann't open file`, `chitu_initial_file_autorun!`
- **USB einstecken**: `USB disk_ok`, `ok`


10. Konfigurations- und Diagnose-Dumps (Beispiele)
--------------------------------------------------
- **M8512 Backup (übersetzt)** – zeigt typische Parameter (Z-Richtung, Geschwindigkeiten, Auflösung, Offset, Lüftersteuerung etc.).
- **M8093 Diagnose** – enthält IDs, Update-Hinweise und Statusfelder (LCD, Treiber, Speicher, Kommunikation).


11. Zusätzliche nicht-FDM-Befehle (aus CHITU_FIRMWARE_COMMANDS_Translated_V1.4.0.txt)
------------------------------------------------------------------------------------
Diese Befehle sind nicht auf XY-/Extrusionsachsen gerichtet und ergänzen obige Resin-Befehle:
- **M8000 I0/I1** – Stromausfall-Speicherung aktivieren/deaktivieren (Neustart nötig).
- **M8001 I0/I1** – Gesteuertes Ausschalten während des Drucks erlauben; Neustart nötig.
- **M8086 I<divider>** – Software-Frequenzteilung für Schrittmotoren (z.B. 0,9°/Schritt oder externe 32‑uSteps).
- **M8087 I<ns> T<ns>** – Externe-Treiber-Timings (siehe oben; hier der Vollständigkeit halber erneut aufgeführt).
- **M8489 I<PWM>** – Vorgabe-PWM (0–256) fürs Mainboard-Lüfter-Anlaufen zur Geräusch-/Luftstromsteuerung.
- **M8510** – Konfiguration sofort anwenden (nicht speichern; Testzwecke).
- **M8511** – Letzte gespeicherte Konfiguration wiederherstellen, verwirft ungespeicherte Änderungen.
- **M8520 I0/I1** – Lasergravur-Menüfunktionen ein-/ausblenden.
- **M6010 T<index> I<count>** – Startpunkt einer Schleife definieren (z.B. T0) und Wiederholungen festlegen.
- **M6011 T<index>** – Schleifenstatus prüfen; springt zurück, bis Wiederholungen erfüllt sind.
- **M6031** – Druck pausieren **ohne** Kopf-/Plattformbewegung.
- **M6032 "<pfad/datei>"** – Druck von SD starten bzw. Datei lesen vorbereiten.
- **M6040 I<ms>** – Drucker nach Verzögerung neu starten.
- **M6045 I<ms> "<Befehl>"** – Druck pausieren, warten, danach Befehl ausführen (z.B. automatisches Resume mit M24).
- **M6046 I<ms> "<Befehl>"** – Wie M6045, aber ohne SD-Stream anzuhalten; blockiert die Dateiübertragung nicht.
- **M6051 D<pin> P<level> I<wait>** – Erweiterungs-IO setzen/überwachen (Pins D0..D7).
